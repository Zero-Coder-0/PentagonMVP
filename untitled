-- 1. Create PROFILES table (Linked to Auth)
create table public.profiles (
  id uuid references auth.users on delete cascade primary key,
  email text,
  role text check (role in ('super_admin', 'tenant_admin', 'vendor', 'sales')) default 'sales',
  created_at timestamp with time zone default timezone('utc'::text, now())
);

-- 2. Create PROPERTIES table (The Inventory)
create table public.properties (
  id uuid default uuid_generate_v4() primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()),
  name text not null,
  developer text,
  status text,
  price_display text,
  price_value numeric,
  location_area text,
  zone text,
  lat float8,
  lng float8,
  specs jsonb default '{}'::jsonb,
  features jsonb default '{}'::jsonb,
  image_urls text[] default array[]::text[],
  user_id uuid references public.profiles(id) -- Who uploaded it?
);

-- 3. Enable RLS (Security)
alter table public.profiles enable row level security;
alter table public.properties enable row level security;

-- 4. Policies (Who can do what?)
-- Everyone can read properties
create policy "Public properties are viewable by everyone" 
on public.properties for select using (true);

-- Only Admins/Vendors can insert properties
create policy "Admins/Vendors can insert properties" 
on public.properties for insert 
with check (exists (
  select 1 from public.profiles
  where profiles.id = auth.uid() and role in ('super_admin', 'vendor')
));

-- Users can read their own profile
create policy "Users can see own profile" 
on public.profiles for select using (auth.uid() = id);

-- 5. AUTOMATIC TRIGGER (Critical for Google Auth)
-- This automatically creates a 'sales' profile when a user logs in with Google
create or replace function public.handle_new_user() 
returns trigger as $$
begin
  insert into public.profiles (id, email, role)
  values (new.id, new.email, 'sales'); -- Default role is SALES
  return new;
end;
$$ language plpgsql security definer;

create trigger on_auth_user_created
  after insert on auth.users
  for each row execute procedure public.handle_new_user();


npx tsc --noEmit && npm run lint



git init
git add .
git commit -m "Initial commit of geoestate"
git config --global user.email "you@example.com"
git config --global user.name "Your Name"
git remote add origin https://github.com/Zero-Coder-0/PentagonMVP.git
git branch -M main
git push -u origin main




this is the file which worked and i have the project made and uploaded in the github for your reference for the folder structure i am using lubuntu and i want to now factor this code and put it in separate folders for decoupled development 

so first analyze it then we will move forward what to do with the current code and how to develop the project further also the requirements to be understood from the pdf i will attach
the fithub link is https://github.com/Zero-Coder-0/PentagonMVP/ understand teh folder structure from this and i will stick onto what i was already developing so the git folderand files structure is the current thing which i am focusing on

analyse and wait for my next instructions



understand the product requirement from the pdf and implement the docs.pdf content did you understand and i ma using the lubuntu i installed the vscode but what extensions and packages to install using bash i do not know and i want you to start from scratch setup







for now you please summarize everything what i want what you did what is left and what future updates and folder structure of project and what is your role and also the necessary details that i can pass onto future ai instance of yours to continue the work

did you understand me ?



